# Отчет 6: Аутентификация и авторизация в Go

## 1. Базовая модель пользователя

Создана базовая модель пользователя с полями ID, Username, Email, PasswordHash, CreatedAt, UpdatedAt

## 2. Реализация хеширования паролей

Для безопасного хранения паролей используется библиотека `golang.org/x/crypto/bcrypt`. Реализованы функции:

- `HashPassword` — хеширует пароль с использованием `bcrypt`.
- `CheckPassword` — проверяет корректность введенного пароля.

---

## 3. Генерация и проверка JWT

- использована библиотека `github.com/golang-jwt/jwt/v5`

- Для работы с JWT создана структура `JWTManager`, содержащая методы:

  - `Generate` — генерирует JWT с идентификатором пользователя.
  - `Verify` — проверяет токен и извлекает данные.

---

## 4. Middleware для проверки токена

Создан middleware `AuthMiddleware`, проверяющая JWT в cookie `access_token`.
Если токен отсутствует или некорректен, запрос отклоняется.

---

## 5. Ограничение доступа по ролям

Реализована middleware `RoleMiddleware`, проверяющая наличие у пользователя определенных ролей.

---

## 6. Настройка маршрутов API

- Общедоступные маршруты для регистрации и входа (`/register`, `/login`)
- Защищенные маршруты, доступные только аутентифицированным пользователям (`/profile`)

- Дополнительные маршруты, доступные только пользователям с определенными ролями (например, админам и модераторам).

## **Вывод:**

В ходе работы реализована система аутентификации и авторизации пользователей, включающая:

- хеширование паролей,
- генерацию и валидацию JWT,
- middleware для проверки токена,
- ограничение доступа по ролям,
- защищенные маршруты API.
